---
description: JPA를 사용하면서 지연 로딩 전략으로 인하여 자주 발생하는 N+1 문제에 대해 알아보고 해결 방법에 대해서 알아본다.
---

# N+1 문제가 무엇이고, 해결 방법은 어떤 것인가?(작성중)

### N+1 문제는 무엇인가?

일반적으로 Hibernate는 데이터베이스에서 엔티티를 검색할 때 지연 로딩(lazy loading) 전략을 사용합니다. 이는 연관된 엔티티가 실제로 필요할 때까지 데이터베이스에서 검색하지 않고, 대신에 필요한 순간에 데이터베이스에 추가적인 쿼리를 실행하여 연관된 엔티티를 가져오는 방식입니다.

하지만 이러한 지연 로딩은 N+1 쿼리 문제를 야기할 수 있습니다. 예를 들어, 하나의 쿼리로 부모 엔티티를 검색하고, 그에 연관된 N개의 자식 엔티티를 가져오기 위해 추가적인 N개의 쿼리를 실행해야 합니다. 이는 데이터베이스에 많은 부하를 줄 수 있으며, 성능을 저하시킬 수 있습니다.

### 해결 방법은?

#### Hibernate 설정 - `default_batch_fetch_size`

`default_batch_fetch_size` 옵션은 이러한 N+1 쿼리 문제를 해결하기 위해 사용됩니다. 이 옵션을 설정하면 Hibernate는 연관된 엔티티를 검색할 때 지정된 크기의 배치로 한 번에 가져옵니다. 따라서 N개의 자식 엔티티를 한 번의 쿼리로 가져올 수 있으므로 N+1 쿼리 문제를 해결할 수 있습니다.

이를 통해 데이터베이스의 부하를 줄이고 성능을 향상시킬 수 있습니다. 그러나 `default_batch_fetch_size`를 지나치게 크게 설정하면 메모리 사용량이 증가할 수 있으므로 적절한 값을 선택하는 것이 중요합니다.

따라서 `default_batch_fetch_size`는 Hibernate에서 N+1 쿼리 문제를 최적화하고 성능을 향상시키기 위해 사용되는 옵션이라고 할 수 있습니다.&#x20;

#### Fetch Join 방법(with QueryDSL or JPQL)

